<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Game of bad jumping mechanics</title>
    <link rel="stylesheet" href="css/game.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <script src="js/jquery-3.4.0.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/konva.min.js"></script>
    <script src="js/player.js"></script>
    <script src="js/engine.js"></script>
    <script src="js/map.js"></script>
    <script src="maps/map01.js"></script>
</head>
<body>
<div class="container">
    <div class="row">
        <div class="col-12 mb-2">
            <a href="#">Уровень 1</a>
            <a href="#">Уровень 2</a>
            <a href="#">Уровень 3</a>
        </div>
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div id="game" class="w-100">

                    </div>
                </div>
            </div>
        </div>
        <div class="col-12 text-center">
            (C) lalki
        </div>
    </div>
</div>
</body>
</html>
<script>

    //Загрузим текстуры
    var sources = {
        box: 'box.png',
        playerLeft: 'playerLeft.png',
        playerRight: 'playerRight.png',
        playerJumpLeft: 'playerJumpLeft.png',
        playerJumpRight: 'playerJumpRight.png'
    };
    engine.loadImages(sources);

    //создаём контейнер
    var stage = new Konva.Stage({
        container: 'game',  // индификатор div контейнера
        width: 1070,
        height: 500
    });
    // далее создаём слой хитбоксов
    var layerHits = new Konva.Layer();
    var layerImg = new Konva.Layer();
    // далее инициализируем карту
    initMap(map01);

    // зададим начальные координаты игрока (центр)
    player.x = stage.width() / 2;
    player.y = stage.height() / 2;

    // создадим фигуру игрока
    player.entity = new Konva.Rect({
        x: player.x,
        y: player.y,
        name: 'player',
        width: 25,
        height: 25
    });

    //Подтянем для него текстуры
    player.entityImage.left = new Konva.Image({
        image: engine.images['playerLeft'],
        x: player.x-5,
        y: player.y-5,
        name: 'player',
        width: 35,
        height: 35
    });

    player.entityImage.right = new Konva.Image({
        image: engine.images['playerRight'],
        x: -500,
        y: player.y-5,
        name: 'player',
        width: 35,
        height: 35
    });

    player.entityImage.jumpLeft = new Konva.Image({
        image: engine.images['playerJumpLeft'],
        x: -500,
        y: player.y-5,
        name: 'player',
        width: 35,
        height: 35
    });

    player.entityImage.jumpRight = new Konva.Image({
        image: engine.images['playerJumpRight'],
        x: -500,
        y: player.y-5,
        name: 'player',
        width: 35,
        height: 35
    });

    // добавляем игрока на слой
    layerHits.add(player.entity);
    //Добавляем текстуры
    layerImg.add(player.entityImage.left);
    layerImg.add(player.entityImage.right);
    layerImg.add(player.entityImage.jumpLeft);
    layerImg.add(player.entityImage.jumpRight);

    // добавляем слои
    stage.add(layerHits);
    stage.add(layerImg);

    //Отлавливаем нажатия клавишь
    $(document).keyup(function (item) {
        var keyPressed = item.which;
        player.keys.kUp(keyPressed);
    });
    $(document).keydown(function (item) {
        var keyPressed = item.which;
        player.keys.kDown(keyPressed);
    });

    //Запускаем цикл игры
    setInterval(function () {
        engine.render();
    }, 10);
</script>